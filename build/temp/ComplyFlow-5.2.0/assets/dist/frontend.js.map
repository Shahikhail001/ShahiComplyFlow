{"version":3,"file":"frontend.js","sources":["../src/js/frontend.js"],"sourcesContent":["/**\r\n * Frontend JavaScript\r\n *\r\n * Public-facing functionality for ComplyFlow.\r\n *\r\n * @package ComplyFlow\r\n * @since 1.0.0\r\n */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    /**\r\n     * ComplyFlow Frontend Object\r\n     */\r\n    const ComplyFlow = {\r\n        /**\r\n         * Initialize\r\n         */\r\n        init() {\r\n            this.initConsentManager();\r\n        },\r\n\r\n        /**\r\n         * Initialize consent manager\r\n         */\r\n        initConsentManager() {\r\n            // Check if consent already given\r\n            if (this.hasConsent()) {\r\n                this.loadConsentedScripts();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Check if user has given consent\r\n         */\r\n        hasConsent() {\r\n            const consent = this.getCookie('complyflow_consent');\r\n            return consent !== null;\r\n        },\r\n\r\n        /**\r\n         * Get cookie value\r\n         */\r\n        getCookie(name) {\r\n            const value = `; ${document.cookie}`;\r\n            const parts = value.split(`; ${name}=`);\r\n            if (parts.length === 2) {\r\n                return parts.pop().split(';').shift();\r\n            }\r\n            return null;\r\n        },\r\n\r\n        /**\r\n         * Load scripts that require consent\r\n         */\r\n        loadConsentedScripts() {\r\n            const consent = JSON.parse(this.getCookie('complyflow_consent') || '{}');\r\n\r\n            // Find all blocked scripts\r\n            document.querySelectorAll('[data-complyflow-blocked]').forEach((placeholder) => {\r\n                const category = placeholder.dataset.category;\r\n\r\n                // Check if category is consented\r\n                if (consent[category]) {\r\n                    this.injectScript(placeholder);\r\n                }\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Inject blocked script\r\n         */\r\n        injectScript(placeholder) {\r\n            const scriptSrc = placeholder.dataset.src;\r\n            const scriptType = placeholder.dataset.type || 'text/javascript';\r\n\r\n            const script = document.createElement('script');\r\n            script.src = scriptSrc;\r\n            script.type = scriptType;\r\n            script.async = true;\r\n\r\n            placeholder.replaceWith(script);\r\n        },\r\n    };\r\n\r\n    /**\r\n     * Initialize on DOM ready\r\n     */\r\n    if (document.readyState === 'loading') {\r\n        document.addEventListener('DOMContentLoaded', () => ComplyFlow.init());\r\n    } else {\r\n        ComplyFlow.init();\r\n    }\r\n\r\n    // Expose to global scope\r\n    window.ComplyFlow = ComplyFlow;\r\n\r\n})();\r\n"],"names":["ComplyFlow","init","this","initConsentManager","hasConsent","loadConsentedScripts","getCookie","name","parts","document","cookie","split","length","pop","shift","consent","JSON","parse","querySelectorAll","forEach","placeholder","category","dataset","injectScript","scriptSrc","src","scriptType","type","script","createElement","async","replaceWith","readyState","addEventListener","window"],"mappings":"YAeI,MAAMA,EAAa,CAIf,IAAAC,GACIC,KAAKC,oBACT,EAKA,kBAAAA,GAEQD,KAAKE,cACLF,KAAKG,sBAEb,EAKA,UAAAD,GAEI,OAAmB,OADHF,KAAKI,UAAU,qBAEnC,EAKA,SAAAA,CAAUC,GACN,MACMC,EADQ,KAAKC,SAASC,SACRC,MAAM,KAAKJ,MAC/B,OAAqB,IAAjBC,EAAMI,OACCJ,EAAMK,MAAMF,MAAM,KAAKG,QAE3B,IACX,EAKA,oBAAAT,GACI,MAAMU,EAAUC,KAAKC,MAAMf,KAAKI,UAAU,uBAAyB,MAGnEG,SAASS,iBAAiB,6BAA6BC,QAASC,IAC5D,MAAMC,EAAWD,EAAYE,QAAQD,SAGjCN,EAAQM,IACRnB,KAAKqB,aAAaH,IAG9B,EAKA,YAAAG,CAAaH,GACT,MAAMI,EAAYJ,EAAYE,QAAQG,IAChCC,EAAaN,EAAYE,QAAQK,MAAQ,kBAEzCC,EAASnB,SAASoB,cAAc,UACtCD,EAAOH,IAAMD,EACbI,EAAOD,KAAOD,EACdE,EAAOE,OAAQ,EAEfV,EAAYW,YAAYH,EAC5B,GAMwB,YAAxBnB,SAASuB,WACTvB,SAASwB,iBAAiB,mBAAoB,IAAMjC,EAAWC,QAE/DD,EAAWC,OAIfiC,OAAOlC,WAAaA,CAExB"}