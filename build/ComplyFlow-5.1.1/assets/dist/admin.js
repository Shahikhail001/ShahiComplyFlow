!function(t){const e={init(){this.cacheElements(),this.bindEvents(),this.initComponents()},cacheElements(){this.$indicator=t("#complyflow-save-indicator"),this.$indicatorSpinner=this.$indicator.find(".spinner"),this.$notices=t("#complyflow-settings-notices")},bindEvents(){t(document).on("submit",".complyflow-settings-form",this.saveSettings.bind(this)),t(document).on("click",".complyflow-tab",this.switchTab.bind(this)),t(document).on("click",".complyflow-run-scan",this.runScan.bind(this))},initComponents(){"undefined"!=typeof tippy&&tippy("[data-tippy-content]"),"undefined"!=typeof Chart&&this.initCharts()},saveSettings(i){i.preventDefault();const s=t(i.currentTarget),n=s.find('button[type="submit"]'),o=n.text();n.prop("disabled",!0).text(complyflowAdmin.strings.saving||"Saving..."),this.clearNotices(),this.setSaveIndicator(!0,complyflowAdmin.strings.saving||"Saving..."),t.ajax({url:complyflowAdmin.ajaxUrl,type:"POST",data:{action:"complyflow_save_settings",nonce:complyflowAdmin.nonce,settings:s.serialize()},success(t){t.success?e.showNotice("success",complyflowAdmin.strings.saved):e.showNotice("error",t.data.message||complyflowAdmin.strings.error)},error(){e.showNotice("error",complyflowAdmin.strings.error)},complete(){n.prop("disabled",!1).text(o),e.setSaveIndicator(!1)}})},switchTab(e){e.preventDefault();const i=t(e.currentTarget),s=i.data("tab");if(t(".complyflow-tab").removeClass("active"),i.addClass("active"),t(".complyflow-tab-content").removeClass("active"),t(`.complyflow-tab-content[data-tab="${s}"]`).addClass("active"),history.pushState){const t=new URL(window.location);t.searchParams.set("tab",s),history.pushState({},"",t)}},runScan(i){i.preventDefault();const s=t(i.currentTarget),n=s.text();s.prop("disabled",!0).text("Scanning..."),t.ajax({url:complyflowAdmin.ajaxUrl,type:"POST",data:{action:"complyflow_run_scan",nonce:complyflowAdmin.nonce},success(t){t.success?(e.showNotice("success","Scan completed successfully"),location.reload()):e.showNotice("error",t.data.message)},error(){e.showNotice("error","Scan failed. Please try again.")},complete(){s.prop("disabled",!1).text(n)}})},showNotice(e,i){const s=t(`\n                <div class="notice notice-${e} is-dismissible">\n                    <p>${i}</p>\n                    <button type="button" class="notice-dismiss">\n                        <span class="screen-reader-text">Dismiss</span>\n                    </button>\n                </div>\n            `),n=this.$notices.length?this.$notices:t(".complyflow-page-header");this.$notices.length?this.$notices.empty().append(s):n.after(s),setTimeout(()=>{s.fadeOut(()=>s.remove())},5e3),s.find(".notice-dismiss").on("click",function(){s.fadeOut(()=>s.remove())})},initCharts(){const e=t("#complyflow-score-chart");if(e.length){const t=parseInt(e.data("score"),10)||0;new Chart(e[0],{type:"doughnut",data:{datasets:[{data:[t,100-t],backgroundColor:["#06d6a0","#e5e7eb"],borderWidth:0}]},options:{cutout:"80%",plugins:{legend:{display:!1},tooltip:{enabled:!1}}}})}},clearNotices(){this.$notices.length&&this.$notices.empty()},setSaveIndicator(t,e=""){this.$indicator&&this.$indicator.length&&(t?(this.$indicator.addClass("is-active").attr("aria-hidden","false"),this.$indicatorSpinner.length&&this.$indicatorSpinner.addClass("is-active"),e&&this.$indicator.find(".save-text").text(e)):(this.$indicator.removeClass("is-active").attr("aria-hidden","true"),this.$indicatorSpinner.length&&this.$indicatorSpinner.removeClass("is-active")))}};t(document).ready(()=>{e.init()})}(jQuery);
//# sourceMappingURL=admin.js.map
