var e,n,o;e=jQuery,n={init:function(){this.checkConsent(),this.bindEvents()},checkConsent:function(){this.getConsent()?e("#complyflow-consent-banner").remove():setTimeout(function(){e("#complyflow-consent-banner").fadeIn(600)},3e3)},getConsent:function(){for(var e="complyflow_consent=",n=decodeURIComponent(document.cookie).split(";"),o=0;o<n.length;o++){for(var t=n[o];" "===t.charAt(0);)t=t.substring(1);if(0===t.indexOf(e))try{return JSON.parse(t.substring(19,t.length))}catch(c){return null}}return null},setConsent:function(e){var n=complyflowConsent.settings.consentDuration||365,o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var t="expires="+o.toUTCString();document.cookie="complyflow_consent="+JSON.stringify(e)+";"+t+";path=/;SameSite=Lax";var c=new CustomEvent("complyflowConsentUpdated",{detail:e});document.dispatchEvent(c)},bindEvents:function(){var n=this;e(document).on("click","#cf-consent-accept-all",function(e){e.preventDefault(),n.acceptAll()}),e(document).on("click","#cf-consent-reject-all",function(e){e.preventDefault(),n.rejectAll()}),e(document).on("click","#cf-consent-save-preferences",function(e){e.preventDefault(),n.savePreferences()}),e(document).on("click","#cf-cookie-settings",function(e){e.preventDefault(),n.showPreferences()}),e(document).on("change",".cf-consent-toggle input",function(){var n=e(this);n.attr("id").replace("complyflow-toggle-",""),n.closest(".cf-consent-category").toggleClass("active",n.prop("checked"))})},acceptAll:function(){var n=this,o={necessary:!0,analytics:!0,marketing:!0,preferences:!0};e("#complyflow-consent-banner").fadeOut(400,function(){n.saveConsent(o)})},rejectAll:function(){var n=this,o={necessary:!0,analytics:!1,marketing:!1,preferences:!1};e("#complyflow-consent-banner").fadeOut(400,function(){n.saveConsent(o)})},savePreferences:function(){var n=this,o={necessary:!0,analytics:e("#cf-toggle-analytics").prop("checked"),marketing:e("#cf-toggle-marketing").prop("checked"),preferences:e("#cf-toggle-preferences").prop("checked")};e("#complyflow-consent-banner").fadeOut(400,function(){n.saveConsent(o)})},saveConsent:function(n){var o=this;this.showLoading();var t={action:"complyflow_save_consent",nonce:complyflowConsent.nonce,necessary:n.necessary?"true":"false",analytics:n.analytics?"true":"false",marketing:n.marketing?"true":"false",preferences:n.preferences?"true":"false"};e.ajax({url:complyflowConsent.ajaxUrl,type:"POST",data:t,success:function(t){t.success?(o.setConsent(n),setTimeout(function(){window.location.reload()},300)):(console.error("ComplyFlow: Save failed",t),alert(t.data.message||"Failed to save consent"),o.hideLoading(),e("#complyflow-consent-banner").fadeIn(300))},error:function(e,n,t){console.error("ComplyFlow: AJAX error",e,n,t),alert("Failed to save consent. Please try again."),o.hideLoading()}})},showPreferences:function(){e(".cf-consent-categories").is(":visible")?e("html, body").animate({scrollTop:e(".cf-consent-categories").offset().top-100},500):(e(".cf-consent-categories").slideDown(),e("#complyflow-cookie-settings").text("Hide Settings"))},hideBanner:function(){e("#complyflow-consent-banner").fadeOut(300,function(){e(this).remove()})},showLoading:function(){e(".cf-consent-actions button").prop("disabled",!0).addClass("loading")},hideLoading:function(){e(".cf-consent-actions button").prop("disabled",!1).removeClass("loading")}},o={scan:function(n){return e.ajax({url:complyflowConsent.ajaxUrl,type:"POST",data:{action:"complyflow_scan_cookies",nonce:complyflowConsent.nonce,url:n||window.location.href}})}},e(document).ready(function(){n.init()}),window.ComplyFlowConsent={banner:n,scanner:o};
//# sourceMappingURL=consent-banner.js.map
